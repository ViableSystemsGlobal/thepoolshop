{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/nanasasu/Desktop/adpoolsgroup/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/nanasasu/Desktop/adpoolsgroup/src/app/api/public/shop/addresses/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\nimport { cookies } from \"next/headers\";\nimport { verify } from \"jsonwebtoken\";\n\nconst JWT_SECRET = process.env.NEXTAUTH_SECRET || \"adpools-secret-key-2024-production-change-me\";\n\n// GET /api/public/shop/addresses - Get customer addresses\nexport async function GET() {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"customer_token\")?.value;\n\n    if (!token) {\n      return NextResponse.json(\n        { error: \"Authentication required\" },\n        { status: 401 }\n      );\n    }\n\n    let decoded: any;\n    try {\n      decoded = verify(token, JWT_SECRET);\n    } catch (error) {\n      return NextResponse.json(\n        { error: \"Invalid token\" },\n        { status: 401 }\n      );\n    }\n\n    if (decoded.type !== \"customer\") {\n      return NextResponse.json(\n        { error: \"Invalid token type\" },\n        { status: 401 }\n      );\n    }\n\n    // Get customer addresses\n    const addresses = await prisma.customerAddress.findMany({\n      where: { customerId: decoded.id },\n      orderBy: [\n        { isDefault: \"desc\" },\n        { createdAt: \"desc\" },\n      ],\n    });\n\n    return NextResponse.json({ addresses });\n  } catch (error) {\n    console.error(\"Error fetching addresses:\", error);\n    return NextResponse.json(\n      { error: \"Failed to fetch addresses\" },\n      { status: 500 }\n    );\n  }\n}\n\n// POST /api/public/shop/addresses - Create new address\nexport async function POST(request: NextRequest) {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"customer_token\")?.value;\n\n    if (!token) {\n      return NextResponse.json(\n        { error: \"Authentication required\" },\n        { status: 401 }\n      );\n    }\n\n    let decoded: any;\n    try {\n      decoded = verify(token, JWT_SECRET);\n    } catch (error) {\n      return NextResponse.json(\n        { error: \"Invalid token\" },\n        { status: 401 }\n      );\n    }\n\n    if (decoded.type !== \"customer\") {\n      return NextResponse.json(\n        { error: \"Invalid token type\" },\n        { status: 401 }\n      );\n    }\n\n    const body = await request.json();\n    const { \n      label, \n      firstName,\n      lastName,\n      phone: addressPhone,\n      street, \n      city, \n      region, \n      postalCode, \n      country, \n      isDefault \n    } = body;\n\n    // Validate required fields\n    if (!street || !city || !region || !country) {\n      return NextResponse.json(\n        { error: \"Street, city, region, and country are required\" },\n        { status: 400 }\n      );\n    }\n\n    // Get customer\n    const customer = await prisma.customer.findUnique({\n      where: { id: decoded.id },\n    });\n\n    if (!customer) {\n      return NextResponse.json(\n        { error: \"Customer not found\" },\n        { status: 404 }\n      );\n    }\n\n    // If setting as default, unset other defaults\n    if (isDefault) {\n      await prisma.customerAddress.updateMany({\n        where: { customerId: decoded.id, isDefault: true },\n        data: { isDefault: false },\n      });\n    }\n\n    // Create new address\n    const address = await prisma.customerAddress.create({\n      data: {\n        customerId: decoded.id,\n        label: label || \"Home\",\n        firstName: firstName || customer.firstName,\n        lastName: lastName || customer.lastName,\n        phone: addressPhone || customer.phone,\n        street,\n        city,\n        region,\n        country: country || \"Ghana\",\n        postalCode: postalCode || \"\",\n        isDefault: isDefault || false,\n      },\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: \"Address saved successfully\",\n      address,\n    });\n  } catch (error) {\n    console.error(\"Error creating address:\", error);\n    return NextResponse.json(\n      { error: \"Failed to create address\" },\n      { status: 500 }\n    );\n  }\n}\n\n// PUT /api/public/shop/addresses - Update address\nexport async function PUT(request: NextRequest) {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"customer_token\")?.value;\n\n    if (!token) {\n      return NextResponse.json(\n        { error: \"Authentication required\" },\n        { status: 401 }\n      );\n    }\n\n    let decoded: any;\n    try {\n      decoded = verify(token, JWT_SECRET);\n    } catch (error) {\n      return NextResponse.json(\n        { error: \"Invalid token\" },\n        { status: 401 }\n      );\n    }\n\n    if (decoded.type !== \"customer\") {\n      return NextResponse.json(\n        { error: \"Invalid token type\" },\n        { status: 401 }\n      );\n    }\n\n    const body = await request.json();\n    const { \n      id,\n      label,\n      firstName,\n      lastName,\n      phone: addressPhone,\n      street, \n      city, \n      region, \n      postalCode, \n      country, \n      isDefault \n    } = body;\n\n    if (!id) {\n      return NextResponse.json(\n        { error: \"Address ID is required\" },\n        { status: 400 }\n      );\n    }\n\n    // Verify address belongs to customer\n    const address = await prisma.customerAddress.findFirst({\n      where: {\n        id,\n        customerId: decoded.id,\n      },\n    });\n\n    if (!address) {\n      return NextResponse.json(\n        { error: \"Address not found\" },\n        { status: 404 }\n      );\n    }\n\n    // If setting as default, unset other defaults\n    if (isDefault && !address.isDefault) {\n      await prisma.customerAddress.updateMany({\n        where: { customerId: decoded.id, isDefault: true },\n        data: { isDefault: false },\n      });\n    }\n\n    // Update address\n    const updatedAddress = await prisma.customerAddress.update({\n      where: { id },\n      data: {\n        label: label || address.label,\n        firstName: firstName || address.firstName,\n        lastName: lastName || address.lastName,\n        phone: addressPhone || address.phone,\n        street: street || address.street,\n        city: city || address.city,\n        region: region || address.region,\n        country: country || address.country,\n        postalCode: postalCode || address.postalCode,\n        isDefault: isDefault !== undefined ? isDefault : address.isDefault,\n      },\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: \"Address updated successfully\",\n      address: updatedAddress,\n    });\n  } catch (error) {\n    console.error(\"Error updating address:\", error);\n    return NextResponse.json(\n      { error: \"Failed to update address\" },\n      { status: 500 }\n    );\n  }\n}\n\n// DELETE /api/public/shop/addresses - Delete address\nexport async function DELETE(request: NextRequest) {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"customer_token\")?.value;\n\n    if (!token) {\n      return NextResponse.json(\n        { error: \"Authentication required\" },\n        { status: 401 }\n      );\n    }\n\n    let decoded: any;\n    try {\n      decoded = verify(token, JWT_SECRET);\n    } catch (error) {\n      return NextResponse.json(\n        { error: \"Invalid token\" },\n        { status: 401 }\n      );\n    }\n\n    if (decoded.type !== \"customer\") {\n      return NextResponse.json(\n        { error: \"Invalid token type\" },\n        { status: 401 }\n      );\n    }\n\n    const { searchParams } = new URL(request.url);\n    const id = searchParams.get(\"id\");\n\n    if (!id) {\n      return NextResponse.json(\n        { error: \"Address ID is required\" },\n        { status: 400 }\n      );\n    }\n\n    // Verify address belongs to customer and delete\n    const address = await prisma.customerAddress.findFirst({\n      where: {\n        id,\n        customerId: decoded.id,\n      },\n    });\n\n    if (!address) {\n      return NextResponse.json(\n        { error: \"Address not found\" },\n        { status: 404 }\n      );\n    }\n\n    await prisma.customerAddress.delete({\n      where: { id },\n    });\n\n    return NextResponse.json({\n      success: true,\n      message: \"Address deleted successfully\",\n    });\n  } catch (error) {\n    console.error(\"Error deleting address:\", error);\n    return NextResponse.json(\n      { error: \"Failed to delete address\" },\n      { status: 500 }\n    );\n  }\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}