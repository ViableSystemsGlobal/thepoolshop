{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Desktop/adpoolsgroup/src/middleware.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\n\nexport function middleware(request: NextRequest) {\n  const { pathname } = request.nextUrl;\n  const hostname = request.headers.get('host') || '';\n  const url = new URL(request.url);\n  const port = url.port || (url.protocol === 'https:' ? '443' : '80');\n  \n  // Determine which domain/port we're on\n  // Port 3000 = Ecommerce (shop), Port 3001 = Admin (sms)\n  const isAdminDomain = hostname.includes('sms.') || hostname.includes('admin.');\n  const isAdminPort = port === '3001' || hostname.includes(':3001');\n  const isShopPort = port === '3000' || hostname.includes(':3000');\n  \n  // Admin domain/port (sms.thepoolshop.africa or localhost:3001)\n  if (isAdminDomain || isAdminPort) {\n    // Block access to shop routes on admin\n    if (pathname.startsWith('/shop')) {\n      return NextResponse.redirect(new URL('/dashboard', request.url));\n    }\n    \n    // Redirect root to dashboard on admin\n    if (pathname === '/') {\n      return NextResponse.redirect(new URL('/dashboard', request.url));\n    }\n    \n    // Allow all other admin routes\n    return NextResponse.next();\n  }\n\n  // Shop domain/port (thepoolshop.africa or localhost:3000) - Ecommerce\n  if (isShopPort || (!isAdminDomain && !isAdminPort)) {\n    // Block access to admin routes on shop (except public APIs)\n    const adminRoutes = [\n      '/dashboard',\n      '/crm',\n      '/drm',\n      '/sales',\n      '/inventory',\n      '/orders',\n      '/quotations',\n      '/invoices',\n      '/payments',\n      '/products',\n      '/warehouses',\n      '/agents',\n      '/tasks',\n      '/reports',\n      '/settings',\n      '/auth',\n    ];\n\n    // Allow API routes and shop routes\n    if (pathname.startsWith('/api') || pathname.startsWith('/shop')) {\n      return NextResponse.next();\n    }\n\n    // Redirect admin routes to shop\n    if (adminRoutes.some(route => pathname.startsWith(route))) {\n      return NextResponse.redirect(new URL('/shop', request.url));\n    }\n\n    // Allow root path to show homepage (not redirect)\n    // Root path will show homepage on shop domain\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public folder\n     */\n    '/((?!_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',\n  ],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAGO,SAAS,WAAW,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IACpC,MAAM,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC,WAAW;IAChD,MAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;IAC/B,MAAM,OAAO,IAAI,IAAI,IAAI,CAAC,IAAI,QAAQ,KAAK,WAAW,QAAQ,IAAI;IAElE,uCAAuC;IACvC,wDAAwD;IACxD,MAAM,gBAAgB,SAAS,QAAQ,CAAC,WAAW,SAAS,QAAQ,CAAC;IACrE,MAAM,cAAc,SAAS,UAAU,SAAS,QAAQ,CAAC;IACzD,MAAM,aAAa,SAAS,UAAU,SAAS,QAAQ,CAAC;IAExD,+DAA+D;IAC/D,IAAI,iBAAiB,aAAa;QAChC,uCAAuC;QACvC,IAAI,SAAS,UAAU,CAAC,UAAU;YAChC,OAAO,2NAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE;QAEA,sCAAsC;QACtC,IAAI,aAAa,KAAK;YACpB,OAAO,2NAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE;QAEA,+BAA+B;QAC/B,OAAO,2NAAY,CAAC,IAAI;IAC1B;IAEA,sEAAsE;IACtE,IAAI,cAAe,CAAC,iBAAiB,CAAC,aAAc;QAClD,4DAA4D;QAC5D,MAAM,cAAc;YAClB;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;SACD;QAED,mCAAmC;QACnC,IAAI,SAAS,UAAU,CAAC,WAAW,SAAS,UAAU,CAAC,UAAU;YAC/D,OAAO,2NAAY,CAAC,IAAI;QAC1B;QAEA,gCAAgC;QAChC,IAAI,YAAY,IAAI,CAAC,CAAA,QAAS,SAAS,UAAU,CAAC,SAAS;YACzD,OAAO,2NAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,SAAS,QAAQ,GAAG;QAC3D;IAEA,kDAAkD;IAClD,8CAA8C;IAChD;IAEA,OAAO,2NAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}